<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 520">
  <style>
    .title { font-family: 'Segoe UI', sans-serif; font-size: 20px; fill: #d4d4d4; font-weight: bold; }
    .subtitle { font-family: 'Segoe UI', sans-serif; font-size: 14px; fill: #808080; }
    .label { font-family: 'Segoe UI', sans-serif; font-size: 12px; fill: #d4d4d4; }
    .code { font-family: 'Fira Code', monospace; font-size: 11px; fill: #d4d4d4; }
    .type { fill: #4ec9b0; }
    .accent { fill: #CE422B; }
    .keyword { fill: #569cd6; }
    .warn { fill: #dcdcaa; }
  </style>
  
  <rect width="100%" height="100%" fill="#1e1e1e"/>
  
  <!-- Título -->
  <text x="400" y="35" text-anchor="middle" class="title">Weak&lt;T&gt; y Ciclos de Referencia</text>
  <text x="400" y="55" text-anchor="middle" class="subtitle">Romper ciclos con referencias débiles</text>
  
  <!-- Problema: Ciclo con Rc -->
  <text x="200" y="85" text-anchor="middle" class="accent" style="font-weight:bold;">❌ PROBLEMA: CICLO</text>
  
  <rect x="40" y="100" width="320" height="180" rx="8" fill="#252526" stroke="#f14c4c"/>
  
  <!-- Nodo A -->
  <rect x="70" y="130" width="100" height="60" rx="6" fill="#2d2d2d" stroke="#CE422B"/>
  <text x="120" y="155" text-anchor="middle" class="label">Node A</text>
  <text x="120" y="175" text-anchor="middle" class="code">strong: <tspan class="accent">2</tspan></text>
  
  <!-- Nodo B -->
  <rect x="230" y="130" width="100" height="60" rx="6" fill="#2d2d2d" stroke="#CE422B"/>
  <text x="280" y="155" text-anchor="middle" class="label">Node B</text>
  <text x="280" y="175" text-anchor="middle" class="code">strong: <tspan class="accent">2</tspan></text>
  
  <!-- Flechas del ciclo -->
  <path d="M170 145 L220 145" stroke="#CE422B" stroke-width="2" fill="none" marker-end="url(#arrowRed)"/>
  <path d="M230 175 L170 175" stroke="#CE422B" stroke-width="2" fill="none" marker-end="url(#arrowRed)"/>
  
  <text x="200" y="220" text-anchor="middle" class="label" style="fill:#f14c4c;">A → B → A (ciclo)</text>
  <text x="200" y="240" text-anchor="middle" class="label" style="fill:#f14c4c;">strong_count nunca llega a 0</text>
  <text x="200" y="260" text-anchor="middle" class="warn" style="font-weight:bold;">⚠️ MEMORY LEAK</text>
  
  <defs>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#CE422B"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4ec9b0"/>
    </marker>
    <marker id="arrowDashed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#808080"/>
    </marker>
  </defs>
  
  <!-- Solución: Weak -->
  <text x="600" y="85" text-anchor="middle" class="type" style="font-weight:bold;">✅ SOLUCIÓN: WEAK</text>
  
  <rect x="440" y="100" width="320" height="180" rx="8" fill="#252526" stroke="#4ec9b0"/>
  
  <!-- Nodo A -->
  <rect x="470" y="130" width="100" height="60" rx="6" fill="#2d2d2d" stroke="#4ec9b0"/>
  <text x="520" y="155" text-anchor="middle" class="label">Node A</text>
  <text x="520" y="175" text-anchor="middle" class="code">strong: <tspan class="type">1</tspan></text>
  
  <!-- Nodo B -->
  <rect x="630" y="130" width="100" height="60" rx="6" fill="#2d2d2d" stroke="#4ec9b0"/>
  <text x="680" y="155" text-anchor="middle" class="label">Node B</text>
  <text x="680" y="175" text-anchor="middle" class="code">strong: <tspan class="type">1</tspan></text>
  
  <!-- Flechas: strong y weak -->
  <path d="M570 145 L620 145" stroke="#4ec9b0" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  <text x="595" y="138" text-anchor="middle" class="code" style="font-size:9px;">Rc</text>
  
  <path d="M630 175 L570 175" stroke="#808080" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowDashed)"/>
  <text x="600" y="168" text-anchor="middle" class="code" style="font-size:9px;fill:#808080;">Weak</text>
  
  <text x="600" y="220" text-anchor="middle" class="label">A → B (strong)</text>
  <text x="600" y="240" text-anchor="middle" class="label" style="fill:#808080;">B → A (weak, no cuenta)</text>
  <text x="600" y="260" text-anchor="middle" class="type" style="font-weight:bold;">✓ Sin memory leak</text>
  
  <!-- Árbol con padre Weak -->
  <text x="400" y="310" text-anchor="middle" class="label" style="font-weight:bold;">PATRÓN: ÁRBOL CON REFERENCIA AL PADRE</text>
  
  <rect x="100" y="330" width="600" height="170" rx="8" fill="#252526" stroke="#3c3c3c"/>
  
  <!-- Root -->
  <rect x="340" y="350" width="120" height="50" rx="6" fill="#2d2d2d" stroke="#4ec9b0" stroke-width="2"/>
  <text x="400" y="375" text-anchor="middle" class="label">Root</text>
  <text x="400" y="392" text-anchor="middle" class="code" style="font-size:10px;">parent: <tspan style="fill:#808080;">Weak::new()</tspan></text>
  
  <!-- Child 1 -->
  <rect x="180" y="430" width="140" height="55" rx="6" fill="#2d2d2d" stroke="#569cd6"/>
  <text x="250" y="455" text-anchor="middle" class="label">Child 1</text>
  <text x="250" y="475" text-anchor="middle" class="code" style="font-size:10px;">parent: <tspan style="fill:#808080;">Weak&lt;Root&gt;</tspan></text>
  
  <!-- Child 2 -->
  <rect x="480" y="430" width="140" height="55" rx="6" fill="#2d2d2d" stroke="#569cd6"/>
  <text x="550" y="455" text-anchor="middle" class="label">Child 2</text>
  <text x="550" y="475" text-anchor="middle" class="code" style="font-size:10px;">parent: <tspan style="fill:#808080;">Weak&lt;Root&gt;</tspan></text>
  
  <!-- Flechas padre->hijos (strong) -->
  <path d="M360 400 L270 425" stroke="#4ec9b0" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  <path d="M440 400 L530 425" stroke="#4ec9b0" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  
  <!-- Flechas hijos->padre (weak) -->
  <path d="M290 430 L380 405" stroke="#808080" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowDashed)"/>
  <path d="M510 430 L420 405" stroke="#808080" stroke-width="2" stroke-dasharray="5,3" fill="none" marker-end="url(#arrowDashed)"/>
  
  <!-- Leyenda -->
  <line x1="640" y1="365" x2="680" y2="365" stroke="#4ec9b0" stroke-width="2"/>
  <text x="695" y="369" class="label" style="font-size:10px;">Rc (strong)</text>
  
  <line x1="640" y1="385" x2="680" y2="385" stroke="#808080" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="695" y="389" class="label" style="font-size:10px;fill:#808080;">Weak</text>
</svg>
